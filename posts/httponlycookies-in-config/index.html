<!doctype html>
<html lang="en-us">
  <head>
    <title>HttpOnlyCookies In Config // Code Talks</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.76.5" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Raskin" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://raskin-soft.github.io/css/main.min.88e7083eff65effb7485b6e6f38d10afbec25093a6fac42d734ce9024d3defbd.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="HttpOnlyCookies In Config"/>
<meta name="twitter:description" content="Problem Description The web application framework, by default, does not set the &ldquo;httpOnly&rdquo; flag for the application&rsquo;s sessionid cookie and other sensitive application cookies. Likewise, the application does not explicitly use the &ldquo;httpOnly&rdquo; cookie flag, thus allowing client scripts to access the cookies by default.
Risk Cookies that contain the user&rsquo;s session identifier, and other sensitive application cookies, are typically accessible by client-side scripts, such as JavaScript. Unless the web application explicitly prevents this using the &ldquo;httpOnly&rdquo; cookie flag, these cookies could be read and accessed by malicious client scripts, such as CrossSite Scripting (XSS)."/>

    <meta property="og:title" content="HttpOnlyCookies In Config" />
<meta property="og:description" content="Problem Description The web application framework, by default, does not set the &ldquo;httpOnly&rdquo; flag for the application&rsquo;s sessionid cookie and other sensitive application cookies. Likewise, the application does not explicitly use the &ldquo;httpOnly&rdquo; cookie flag, thus allowing client scripts to access the cookies by default.
Risk Cookies that contain the user&rsquo;s session identifier, and other sensitive application cookies, are typically accessible by client-side scripts, such as JavaScript. Unless the web application explicitly prevents this using the &ldquo;httpOnly&rdquo; cookie flag, these cookies could be read and accessed by malicious client scripts, such as CrossSite Scripting (XSS)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://raskin-soft.github.io/posts/httponlycookies-in-config/" />
<meta property="article:published_time" content="2020-10-01T01:36:00+00:00" />
<meta property="article:modified_time" content="2020-10-01T01:36:00+00:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://raskin-soft.github.io/"><img class="app-header-avatar" src="/raskin.jpg" alt="Raskin" /></a>
      <h1>Code Talks</h1>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
      </nav>
      <p>This documentaion is based on code snippet. As a professional software developer, we work on diversified technologies which involes a lot of codes/commands and it&#39;s difficult to memorize. This will work as our assistant!</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/raskin-soft" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
          <a target="_blank" href="https://linkedin.com/in/raskinurrashid" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>linkedin</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg></a>
        
          <a target="_blank" href="https://facebook.com/raskinur" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-facebook">
  <title>facebook</title>
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
</svg></a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">HttpOnlyCookies In Config</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Oct 1, 2020
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="problem-description">Problem Description</h1>
<p>The web application framework, by default, does not set the &ldquo;httpOnly&rdquo; flag for the application&rsquo;s sessionid cookie and other sensitive application cookies. Likewise, the application does not explicitly use the &ldquo;httpOnly&rdquo; cookie flag, thus allowing client scripts to access the cookies by default.</p>
<h1 id="risk">Risk</h1>
<p>Cookies that contain the user&rsquo;s session identifier, and other sensitive application cookies, are typically accessible by client-side scripts, such as JavaScript. Unless the web application explicitly prevents this using the &ldquo;httpOnly&rdquo; cookie flag, these cookies could be read and accessed by malicious client scripts, such as CrossSite Scripting (XSS). This flag would mitigate the damage done in case XSS vulnerabilities are discovered, according to Defense in Depth.</p>
<h1 id="general-recommendations">General Recommendations</h1>
<ol>
<li>Always set the &ldquo;httpOnly&rdquo; flag for any sensitive server-side cookie.</li>
<li>It is highly recommended to implement HTTP Strict Transport Security (HSTS) in order to ensure that the cookie will be sent over a secured channel.</li>
<li>Configure the application to always use &ldquo;httpOnly&rdquo; cookies in the site-wide configuration file.</li>
<li>Set the httpOnlyCookies attribute on the <!-- raw HTML omitted --> element, under &lt;system.web&gt; in your application&rsquo;s web.config, to &ldquo;true&rdquo;.</li>
</ol>
<h1 id="source-code-examples">Source Code Examples</h1>
<p>CSharp ASP.NET web.config file without HttpOnly configured</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">    <span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
    <span style="color:#f92672">&lt;configuration&gt;</span>  
        <span style="color:#f92672">&lt;system.web&gt;</span>
            <span style="color:#f92672">&lt;compilation</span> <span style="color:#a6e22e">debug=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">targetFramework=</span><span style="color:#e6db74">&#34;4.0&#34;</span> <span style="color:#f92672">/&gt;</span> 
            <span style="color:#f92672">&lt;authentication</span> <span style="color:#a6e22e">mode=</span><span style="color:#e6db74">&#34;Forms&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;forms</span> <span style="color:#a6e22e">loginUrl=</span><span style="color:#e6db74">&#34;~/default.aspx&#34;</span> <span style="color:#a6e22e">timeout=</span><span style="color:#e6db74">&#34;2880&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;/authentication&gt;</span>
        <span style="color:#f92672">&lt;/system.web&gt;</span>
    <span style="color:#f92672">&lt;/configuration&gt;</span>
</code></pre></div><p>Configuring Secure Cookies with HttpOnly</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">    <span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span> 
    <span style="color:#f92672">&lt;configuration&gt;</span>
        <span style="color:#f92672">&lt;system.web&gt;</span>   
            <span style="color:#f92672">&lt;compilation</span> <span style="color:#a6e22e">debug=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">targetFramework=</span><span style="color:#e6db74">&#34;4.0&#34;</span> <span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;authentication</span> <span style="color:#a6e22e">mode=</span><span style="color:#e6db74">&#34;Forms&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;forms</span> <span style="color:#a6e22e">loginUrl=</span><span style="color:#e6db74">&#34;~/default.aspx&#34;</span> <span style="color:#a6e22e">timeout=</span><span style="color:#e6db74">&#34;2880&#34;</span> <span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;/authentication&gt;</span> 
            <span style="color:#f92672">&lt;httpCookies</span> <span style="color:#a6e22e">domain=</span><span style="color:#e6db74">&#34;MyDomain&#34;</span> <span style="color:#a6e22e">httpOnlyCookies=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">requireSSL=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#f92672">/&gt;</span> 
        <span style="color:#f92672">&lt;/system.web&gt;</span>
    <span style="color:#f92672">&lt;/configuration&gt;</span>
</code></pre></div><h1 id="helpful-links">Helpful Links:</h1>
<ol>
<li><a href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262(v=vs.100)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262(v=vs.100)?redirectedfrom=MSDN</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.requiressl?redirectedfrom=MSDN&amp;view=netframework-4.8#System_Web_Security_FormsAuthentication_RequireSSL">https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.requiressl?redirectedfrom=MSDN&amp;view=netframework-4.8#System_Web_Security_FormsAuthentication_RequireSSL</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.formsauthentication.requiressl?redirectedfrom=MSDN&amp;view=netframework-4.8#System_Web_Security_FormsAuthentication_RequireSSL">https://docs.microsoft.com/en-us/previous-versions//ms533046(v=vs.85)?redirectedfrom=MSDN</a></li>
</ol>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
